var statics = tags[|Static];
var total_statics = ds_list_size(statics);
var total_new_statics = ds_list_size(new_statics);

surface_set_target(surfaces[UNIFORM_BUFFER]);

SET_UNIFORM_I("vertex_mode", VERTEX_FLAT)
SET_UNIFORM_I("fragment_mode", FRAGMENT_UNIFORM_ENCODING)

var next_candidate = 0;
for(var i = 0; i < total_new_statics; i++)
{
    var to_be_added = new_statics[|i];

    var j = next_candidate;

    for(; j < total_statics; j++)
    {
        if(statics[|j] != -1)
            statics[|j] = to_be_added[0];
        else
            continue;

        break;
    }

    if(j == total_statics)
    {
        ds_list_add(statics, to_be_added[0]);
        total_statics++;
    }

    var tag_combo = to_be_added[1];
    tag_combo[1] = j;

    update_static(j);
    next_candidate = j+1;
}

surface_reset_target();

surface_save(surfaces[UNIFORM_BUFFER], "uniform_buffer.png");

ds_list_clear(new_statics);
